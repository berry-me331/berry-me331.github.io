---
layout: single
published: true
title:  "JAVA 언어 : Couse2. Part3 자바 리펙토링, 미니프로젝트 (Feat. 시그니처 백엔드 강의)"
---



## 목차

- [Part 4. 자바 리펙토링 및 미니 프로젝트기](#part3-api-활용하기-1)
  * [Ch01. 실전 API 활용하기 사전지식](#ch01-실전-api-활용하기-사전지식)
  * [Ch02. 실전 API 활용하기 (1)](#ch02-실전-api-활용하기-1)

## Part 4. 자바 리펙토링 및 미니 프로젝트

### Ch01. 실전 API 활용하기 사전지식

* Excel API(POI) 활용하기
  : 자바에서 Apache POI 라이브러리를 사용하여 Excel 파일 읽기 / 쓱 실습
  : 먼저 Apache POI 라이브러리 프로젝트에 추가

  - 라이브러리 관리 툴 : Maven, Gradle
  - Maven > pom.xml 파일에 의존성 추가
  - POI 라이브러리를 사용하여 Excel 파일 읽기
    : Start point > Open Excel File> Read the First Sheet > For each Row in Sheet >  
    For each Cell in Row > Print Cell Value > End Point
  - 행과 열이 있어서 이중 for문의 형태로 핸들링해야 엑셀 핸들링 가능
  - 실제 엑셀파일을 메모리에 있는 가상의 엑셀로 만들어야되는데  Workbook이라고 함
  - Workbook에서 시트가져오고 행가져오고 셀가져오고 출력
  - file 등 스트림들은 전부 다시 닫아주기 `file.close()`


  - `cell.getCellType()`을 통해 타입을 알 수 있음
  - switch case(반복문) 으로 핸들링 하기 좋음(혹은 if else) ~타입이면 ~break 아니면 ~
  - DateUtil.isCellDateFormatted(cell) > 이 셀이 날짜데이터 타입??

<details>
  <summary>
    간단 엑셀 데이터 가져오기 예제
  </summary>

<div markdown="1">
  <br>

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class ExcelExample {
    public static void main(String[] args) {
        try{
            FileInputStream file=new FileInputStream(new File("example.xlsx"));
            //파일에서 읽어와야됨. 파일이름 적어줘야됨. 실제 엑셀파일
            //실제 엑셀파일을 메모리에 있는 가상의 엑셀로 만들어야되는데  Workbook이라고 함
            Workbook workbook= WorkbookFactory.create(file);
            Sheet sheet=workbook.getSheetAt(0);
            for(Row row: sheet){
                for(Cell cell: row){
                    System.out.print(cell+"\t");
                }
                System.out.println();//줄바꿈
            }
            file.close();
            System.out.println("엑셀에서 데이터 읽어오기 성공");
        }catch(IOException e){
            e.printStackTrace();
        }
    }
}
```

</div>
</details>


<details>
  <summary>
    원하는 형식으로 엑셀 가져오기 예제
  </summary>

<div markdown="1">
  <br>


```java
public class ExcelExample {
  public static void main(String[] args) {
    try {
      FileInputStream file = new FileInputStream(new File("example.xlsx"));
      Workbook workbook = WorkbookFactory.create(file);
      Sheet sheet = workbook.getSheetAt(0);
      for (Row row : sheet) {
        for (Cell cell : row) {
          switch (cell.getCellType()) {
            case NUMERIC:
            if (DateUtil.isCellDateFormatted(cell)) {
              Date dateValue = cell.getDateCellValue();
              DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
              String formattedDate = dateFormat.format(dateValue);
              System.out.print(formattedDate + "\t");
            } else {
              double numericValue = cell.getNumericCellValue();
            if (numericValue == Math.floor(numericValue)) {
              int intValue = (int) numericValue;
              System.out.print(intValue + "\t");
            } else {
              System.out.print(numericValue + "\t");
              }
            }
          break;
          case STRING:
              String stringValue = cell.getStringCellValue();
              System.out.print(stringValue + "\t");
              break;
              case BOOLEAN:
              boolean booleanValue = cell.getBooleanCellValue();
              System.out.print(booleanValue + "\t");
              break;
          case FORMULA:
            String formulaValue = cell.getCellFormula();
            System.out.print(formulaValue + "\t");
            break;
          case BLANK:
            System.out.print("\t");
            break;
            default:
            System.out.print("\t");
            break;
            }
            }
            System.out.println();
            }
            file.close();
            } catch (IOException e) {
        e.printStackTrace();
      }
    }
}
```

</div>
</details>

* Excel에 회원정보 저장하기
  : 저장할 VO 키 값들을 포함해 클래스를 생성하고, 그 클래스의 ArrayList를 생성함.
  : Scanner를 받을 준비하고, 스캐너에 입력된 값들을 엑셀에 저장함

  - 첫번째 변수값 입력받을시 quit 나오면 break;할수있게 if문 설정
  - 그전까지는 계속 반복
  - 배열통해서 ~번째 데이터들 엑셀에 순서대로 입력 `MemberVo member=members.get(i);`
  - 
 



<details>
  <summary>
    엑셀에 회원정보 입력하기 예제
  </summary>

<div markdown="1">
  <br>

VO클래스 만들기
```java
public class Member {
  private String name;
  private int age;
  private String birthdate;
  private String phone;
  private String address;
  private boolean isMarried;
  // 생성자, getter, setter, toString()
}
```


```java
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelWriter {
public static void main(String[] args) {
Scanner scanner = new Scanner(System.in);
List<MemberVO> members = new ArrayList<>();
while (true) {
System.out.print("이름을 입력하세요:");
String name = scanner.nextLine();
if (name.equals("quit")) {
break;
}
System.out.print("나이를 입력하세요:");
int age = scanner.nextInt();
scanner.nextLine(); // 개행문자 제거
System.out.print("생년월일을 입력하세요:");
String birthdate = scanner.nextLine();
System.out.print("전화번호를 입력하세요:");
String phone = scanner.nextLine();
System.out.print("주소를 입력하세요:");
String address = scanner.nextLine();
System.out.print("결혼여부를 입력하세요 (true/false):");
boolean isMarried = scanner.nextBoolean();
scanner.nextLine(); // 개행문자 제거
MemberVO member = new MemberVO(name, age, birthdate, phone, address, isMarried);
members.add(member);
}
scanner.close();

try {
XSSFWorkbook workbook = new XSSFWorkbook();
Sheet sheet = workbook.createSheet("회원 정보");
// 헤더 생성
Row headerRow = sheet.createRow(0);
headerRow.createCell(0).setCellValue("이름");
headerRow.createCell(1).setCellValue("나이");
headerRow.createCell(2).setCellValue("생년월일");
headerRow.createCell(3).setCellValue("전화번호");
headerRow.createCell(4).setCellValue("주소");
headerRow.createCell(5).setCellValue("결혼여부");
// 데이터 생성
for (int i = 0; i < members.size(); i++) {
MemberVO member = members.get(i);
Row row = sheet.createRow(i + 1);
row.createCell(0).setCellValue(member.getName());
row.createCell(1).setCellValue(member.getAge());
row.createCell(2).setCellValue(member.getBirthdate());
row.createCell(3).setCellValue(member.getPhone());
row.createCell(4).setCellValue(member.getAddress());
Cell marriedCell = row.createCell(5);
marriedCell.setCellValue(member.isMarried());
}
// 엑셀 파일 저장
String filename = "members.xlsx";
FileOutputStream outputStream = new FileOutputStream(new File(filename));
workbook.write(outputStream);
workbook.close();
System.out.println("엑셀 파일이 저장되었습니다: " + filename);
} catch (IOException e) {
System.out.println("엑셀 파일 저장 중 오류가 발생했습니다.");
e.printStackTrace();
}
}
}

```

</div>
</details>

* Pdf API(iText) 활용하기
  : itext을 이용해서 책정보를 PDF파일에 생성하는 실습

  - `PdfWriter writer = new PdfWriter(new FileOutputStream("book_information.pdf"));` : PdfWriter 객체를 생성하여 PDF파일을 출력하기 위한 스트림을 지정
  - `PdfDocument pdf = new PdfDocumetn(writer);`: PdfWriter 객체를 사용하여 PdfDocument 객체를 생성
  - `Document document=new Document(pdf);` : PdfDocument 객체를 사용하여 Document 객체를 생성한다.
  - 폰트 생성 및 추가 > PdfFontFactory 클래스의 createFont() 메서드를 사용하여 폰트를 생성하고, Document 객체의 setFont() 메서드를 사용하여 폰트를 설정한다
  - 책 정보를 문단으로 생성하여 Document 에 추가 : 책 정보를 HashMap 객체에 저장하고, HashMap의 keySet() 메서드를 사용하여 모든 키를 순회하며 키와 값을 이용하여 문단을 생성
  - `document.close();` : Document 객체를 닫아준다. 

> FileOutputStream >  파일을 만들어서 출력해주는 메서드  
> Pdf writer 라는 객체로 PdfDocument 생성해서 PdfDocument에 넣을 내용들 만들객체  
> Document 객체가 Workbook 처럼 가상의 메모리 느낌   




<details>
  <summary>
    책정보 PDF에 입력하기 예제
  </summary>

<div markdown="1">
  <br>

```java
import com.itextpdf.io.font.PdfEncodings;
import com.itextpdf.kernel.font.PdfFont;
import com.itextpdf.kernel.font.PdfFontFactory;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.element.Paragraph;

import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.time.Year;
import java.util.HashMap;



public class BookInfoToPDF {

        public static void main(String[] args) throws IOException {
            HashMap<String, String> bookInfo = new HashMap<>();
            bookInfo.put("title", "한글    자바");
            bookInfo.put("author", "홍길동");
            bookInfo.put("publisher", "한글    출판사");
            bookInfo.put("year", String.valueOf(Year.now().getValue()));
            bookInfo.put("price", "25000");
            bookInfo.put("pages", "400");


            try {

                            PdfWriter writer = new PdfWriter(new FileOutputStream("book_information.pdf"));
// PdfWriter 객체를    사용하여    PdfDocument 객체    생성
                            PdfDocument pdf = new PdfDocument(writer);
// Document 객체    생성
                            Document document = new Document(pdf);

                            // 폰트    생성    및    추가
                            PdfFont font = PdfFontFactory.createFont("CookieRun Regular.otf", PdfEncodings.IDENTITY_H, true);
                            document.setFont(font);
// 책    정보를    문단으로    생성하여    Document에    추가
                            for (String key : bookInfo.keySet()) {
                                Paragraph paragraph = new Paragraph(key + ": " + bookInfo.get(key));
                                document.add(paragraph);
                            }
// Document 닫기
                            document.close();

                            System.out.println("book_information.pdf 파일이    생성되었습니다.");
                        } catch (FileNotFoundException e) {
                            e.printStackTrace();
                        }
                    }
                }

```
</div>
</details>
  

### Ch02. 실전 API 활용하기 (1)
### Ch03. 실전 API 활용하기 (2)
### Ch04. 실전 API 활용하기 (3)
